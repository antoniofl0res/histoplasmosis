<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Histoplasmosis Research Repository</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(to right, #f0f2f5, #d9e2ec);
            margin: 0;
            padding: 0;
            text-align: center;
        }
        h1 {
            color: #333;
            padding: 20px 0;
        }
        nav {
            display: flex;
            gap: 30px;
            padding: 20px 5%;
            justify-content: center;
        }
        .left-column {
            width: 40%;
            min-width: 400px;
        }
        .right-column {
            width: 60%;
            min-width: 500px;
        }
        ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        li {
            margin: 10px 0;
        }
        a {
            text-decoration: none;
            color: #8B0000;
            font-size: 18px;
            transition: color 0.3s ease;
        }
        a:hover {
            color: #6B0000;
        }
        #visualization-window {
            display: none;
            margin-top: 20px;
            padding: 20px;
            background: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
        }
        iframe {
            width: 100%;
            height: 500px;
            border: none;
        }
        .description {
            text-align: left;
            margin: 20px 0;
            padding: 20px;
            background: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            border-left: 4px solid #dc3545;
        }
        .description li {
            margin: 10px 0;
            padding-left: 1.5em;
            text-indent: -0.7em;
        }
        .description li::before {
            content: "•";
            color: #dc3545;
            font-weight: bold;
            display: inline-block;
            width: 0.7em;
            margin-right: 0.3em;
            vertical-align: middle;
        }
        .how-to-trigger {
            position: relative;
            display: inline-block;
            margin: 10px 0 30px;
            cursor: help;
            color: #2F4F4F;
        }
        .how-to-box {
            display: none;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 400px;
            padding: 15px;
            background: #fff;
            border: 2px solid #dc3545;
            border-radius: 8px;
            box-shadow: 0 3px 15px rgba(0,0,0,0.1);
            z-index: 100;
            text-align: left;
            font-size: 0.9em;
            line-height: 1.5;
        }
        .how-to-trigger:hover .how-to-box {
            display: block;
        }
    </style>
    <script>
        async function showVisualization(link) {
            try {
                const response = await fetch(link);
                if (!response.ok) throw new Error('Network response was not ok');
                const codeContent = await response.text();
                
                const viewer = document.getElementById('viewer');
                const blob = new Blob([codeContent], { type: 'text/plain' });
                viewer.src = URL.createObjectURL(blob);
                
                document.getElementById('visualization-window').style.display = 'block';
            } catch (error) {
                console.error('Error loading file:', error);
                alert('Error loading file: ' + error.message);
            }
        }
    </script>
</head>
<body>
    <h1>Histoplasmosis research repository</h1>
    <div class="how-to-trigger">
        How to use this repository [▾]
        <div class="how-to-box">
            This repository contains interactive tools for analyzing histoplasmosis diagnostics.<br><br>
            • Left column: Interactive calculators with parameter controls<br>
            • Right column: Code visualizations (click to view)<br>
        </div>
    </div>
    <nav>
        <div class="left-column">
            <ul>
                <li>
                    <a href="histo_sequential_testing.html">Sequential testing simulation (HTML)</a>
                    <div class="description">
                        <p>This page is an interactive calculator for evaluating the effectiveness of two sequential medical diagnostic tests (like rapid tests followed by additional lab tests). It allows you to adjust key parameters using sliders:</p>
                        <ul>
                            <li>Probability of disease in the population (prevalence)</li>
                            <li>Test 1 sensitivity & specificity (default: MiraVista LFA rapid test)</li>
                            <li>Test 2 sensitivity & specificity (default: IMMY EIA lab test)</li>
                        </ul>
                        <p>It instantly shows:</p>
                        <ul>
                            <li>How test accuracy affects positive predictive value (PPV)</li>
                            <li>Expected positive rates at each testing stage</li>
                            <li>Visual charts comparing test performance and sample flow</li>
                        </ul>
                        <p>Use this to compare testing strategies and understand how combining tests impacts result reliability. All calculations update automatically as you adjust the sliders.</p>
                    </div>
                </li>
                <li>
                    <a href="Stan_model_visualization.html">"Predicting prevalence" simulation (HTML)</a>
                    <div class="description">
                        <p>This page provides an interactive visualization to explore how sequential testing results might relate to true disease prevalence. It lets you:</p>
                        <ul>
                            <li>Input observed data: Total samples tested, Positive results from first and second tests, Number of retested samples</li>
                            <li>See rough estimates: Approximate disease prevalence in the population, Positive predictive value (PPV) at each testing stage, Basic uncertainty ranges (shown as 95% intervals)</li>
                        </ul>
                        <p>Key notes:</p>
                        <ul>
                            <li>Uses fixed test accuracy values (Test 1: 92% sensitivity/95% specificity; Test 2: 91% sensitivity/96% specificity)</li>
                            <li>Shows a simplified probability distribution chart to help understand how test results might map to prevalence</li>
                            <li>This is not for real-world use - the full statistical model (shown below) handles complex uncertainty</li>
                        </ul>
                        <p>Purpose: Help users build intuition about how sequential testing data could inform prevalence estimates, before diving into more rigorous analysis. All calculations update as you adjust the numbers.</p>
                    </div>
                </li>
            </ul>
        </div>
        <div class="right-column">
            <ul>
                <li><a href="#" onclick="event.preventDefault(); showVisualization('histo_seq_testing.R')">Sequential testing model (R)</a></li>
                <li><a href="#" onclick="event.preventDefault(); showVisualization('model_seq_pos_retested_binom.stan')">Sequential testing model (Stan)</a></li>
            </ul>
                <li><a href="#" onclick="event.preventDefault(); showVisualization('histo_treat_Markov_model.R')">Markov treatment model (R)</a></li>
                
            <div id="visualization-window">
                <iframe id="viewer"></iframe>
            </div>
        </div>
    </nav>
</body>
</html>
